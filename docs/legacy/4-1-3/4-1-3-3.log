2025-05-17T18:42:25.528+03:00  INFO 14844 --- [common] [nio-8080-exec-3] c.m.f.command.CommandController          : Received WithdrawCommand: com.mayosen.financeapp.command.api.v1.WithdrawRequest@59cc3c79
2025-05-17T18:42:25.531+03:00  INFO 14844 --- [common] [nio-8080-exec-3] c.m.financeapp.command.CommandHandler    : Processing WithdrawCommand: com.mayosen.financeapp.command.WithdrawCommand@4c1b6f42
2025-05-17T18:42:25.535+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL query
2025-05-17T18:42:25.535+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL statement [SELECT "SNAPSHOT"."BALANCE" AS "BALANCE", "SNAPSHOT"."TIMESTAMP" AS "TIMESTAMP", "SNAPSHOT"."AGGREGATE_ID" AS "AGGREGATE_ID", "SNAPSHOT"."LAST_SEQUENCE_NUMBER" AS "LAST_SEQUENCE_NUMBER" FROM "SNAPSHOT" WHERE "SNAPSHOT"."AGGREGATE_ID" = ?]
2025-05-17T18:42:25.540+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL query
2025-05-17T18:42:25.540+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL statement [SELECT "EVENT"."EVENT_ID" AS "EVENT_ID", "EVENT"."TIMESTAMP" AS "TIMESTAMP", "EVENT"."EVENT_TYPE" AS "EVENT_TYPE", "EVENT"."AGGREGATE_ID" AS "AGGREGATE_ID", "EVENT"."EVENT_FIELDS" AS "EVENT_FIELDS", "EVENT"."SEQUENCE_NUMBER" AS "SEQUENCE_NUMBER" FROM "EVENT" WHERE "EVENT"."AGGREGATE_ID" = ?]
2025-05-17T18:42:25.557+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL query
2025-05-17T18:42:25.557+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL statement [SELECT MAX(sequence_number) FROM event WHERE aggregate_id = ? ]
2025-05-17T18:42:25.571+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL update
2025-05-17T18:42:25.571+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL statement [INSERT INTO "EVENT" ("AGGREGATE_ID", "EVENT_FIELDS", "EVENT_ID", "EVENT_TYPE", "SEQUENCE_NUMBER", "TIMESTAMP") VALUES (?, ?, ?, ?, ?, ?)]
2025-05-17T18:42:25.575+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL query
2025-05-17T18:42:25.576+03:00 DEBUG 14844 --- [common] [nio-8080-exec-3] o.s.jdbc.core.JdbcTemplate               : Executing prepared SQL statement [SELECT COUNT(*) FROM "EVENT" WHERE "EVENT"."AGGREGATE_ID" = ?]
2025-05-17T18:42:25.577+03:00  INFO 14844 --- [common] [nio-8080-exec-3] c.m.financeapp.command.CommandHandler    : Successfully processed events for aggregate 7e668605-04b0-466c-b1bc-1a431c8aa27b
2025-05-17T18:42:25.717+03:00  INFO 14844 --- [common] [mmon-producer-1] c.m.f.event.kafka.KafkaEventPublisher    : Message sent SendResult [producerRecord=ProducerRecord(topic=financeapp-events, partition=null, headers=RecordHeaders(headers = [], isReadOnly = true), key=7e668605-04b0-466c-b1bc-1a431c8aa27b, value={"type":"com.mayosen.financeapp.event.WithdrawalPerformedEvent","event":{"eventId":"da83d018-e01b-4b62-b11c-09670844f53a","aggregateId":"7e668605-04b0-466c-b1bc-1a431c8aa27b","timestamp":1747496545.556057100,"amount":50}}, timestamp=null), recordMetadata=financeapp-events-0@3]
